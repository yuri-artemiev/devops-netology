
# Домашнее задание к занятию "3.2. Работа в терминале, лекция 2"

1. Какого типа команда cd?  
Для проверки типа команды можно использовать команду `type`  
```
type cd
cd is a shell builtin
```
Это значит, что команда является встроенной в оболочку. Возможно это сделано для того, чтобы директория менялась в текущей оболочке. Если бы команда была внешней, то директория менялась по отношению к этой команде.  
2. Какая альтернатива без pipe команде grep <some_string> <some_file> | wc -l?  
Альтернатива использовать ключ `-c` для подсчётка количества вхождений  
`grep -c <some_string> <some_file>`  
3. Какой процесс с PID 1 является родителем для всех процессов в вашей виртуальной машине Ubuntu 20.04?  
`systemd` с PID 1  
```
pstree -p
systemd(1)─┬─VBoxService(873)─┬─{VBoxService}(874)
           │                  ├─{VBoxService}(875)
           ...
           ├─accounts-daemon(675)─┬─{accounts-daemon}(686)
           │                      └─{accounts-daemon}(883)
           ├─atd(712)
           ├─cron(710)
           ...
```
4. Как будет выглядеть команда, которая перенаправит вывод stderr ls на другую сессию терминала?  
Команда `ls . 2>/dev/tty4` выведет ошибки списка файлов в текущем каталоге на терминал 4  
`2` - поток ошибок  
`>` - перенаправление потока  
`/dev/tty4` - устройство терминала  
Команда для просмотра текущего терминала `tty`  
5. Получится ли одновременно передать команде файл на stdin и вывести ее stdout в другой файл?  
Команда `cat <file1 >file2` выведет содержимое файла file1 и отправит его в файл file2  
6. Получится ли находясь в графическом режиме, вывести данные из PTY в какой-либо из эмуляторов TTY?  
Да, можно. Пример с обозначениями:  
  - ssh - вывод на ssh подлкючение к серверу  
  - local - вывод на локальный тероминал на том же сервере  
  
| Команда                       | ssh        | local      |
| ------------------------------| ---------- | ---------- |
| tty                           | /dev/pts/0 | /dev/tty1  |
| cat /etc/hostname > /dev/tty1 |            | vagrant    |
| echo "test" > /dev/tty1       |            | test       |
  
7. Выполните команду bash 5>&1. К чему она приведет?  
Это команда открывает файловый дескриптор 5 и перенаправляет его вывод в стандартный вывод (stdout 1)
Посмотреть открытые файловые дескрипторы можно командой `ls -la /proc/$$/fd/`  
```
lrwx------ 1 root root 64 Jun 13 12:41 0 -> /dev/pts/0
lrwx------ 1 root root 64 Jun 13 12:41 1 -> /dev/pts/0
lrwx------ 1 root root 64 Jun 13 12:41 2 -> /dev/pts/0
lrwx------ 1 root root 64 Jun 13 12:41 255 -> /dev/pts/0
lrwx------ 1 root root 64 Jun 13 12:41 5 -> /dev/pts/0
```
  
Что будет, если вы выполните echo netology > /proc/$$/fd/5  
    Произойдёт вывод текста `netology` в консоли. Потому что произошло перенаправление из дескриптора 5 в дексриптор 1 (stdout)  
8. Получится ли в качестве входного потока для pipe использовать только stderr команды, не потеряв при этом отображение stdout на pty?  
Можно поменять местами stdout и stderr командой `command 3>&1 1>&2 2>&3`  
Это команда открывает файловый дескриптор 3 и перенаправляет его в файловый дескриптор 1 (stdout)  
Файловый дескриптор 1 (stdout) в файловый дескриптор 2 (stderr)  
Файловый дескриптор 2 (stderr) в файловый дескриптор 3 (т.е. в stdout)  
В результате выводы stdout и stderr поменялись местами  
9. Что выведет команда cat /proc/$$/environ?  
Эта команда выводит переменные окружения для текущего процесса (переменная $$)  
Можно использовать команду `env` для получения этого списка  
10. Что доступно по адресам /proc/PID/cmdline, /proc/PID/exe?  
PID - идентификатор запущенного процесса (его номер)  
`/proc/<PID>/cmdline` какая команда была использована для запуска процесса (пробелы заменены нуль-символами)  
`/proc/<PID>/exe` является символьной ссылкой на исполняемый файл процесса  
11. Какую наиболее старшую версию набора инструкций SSE поддерживает ваш процессор с помощью /proc/cpuinfo?  
sse4_2  
12. Почему так происходит, в команде ниже?  
```
vagrant@netology1:~$ ssh localhost 'tty'  
not a tty  
```
При запуске команды выдаёт запрос на добавление открытого ключа в доверенные  
```
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ECDSA key fingerprint is SHA256:RztZ...
Are you sure you want to continue connecting (yes/no/[fingerprint])?
```
Если выбать `yes` - ключ добавиться в доверенныe. Список доверенных ключей храниться в файле `~/.ssh/authorized_keys`  
13. Как переместить запущенный процесс из одной сессии в другую, воспользовавшись `reptyr`?  
Узнать PID процесса и запустить команду `reptyr PID`  
14. Что делает команда tee в команде ниже и почему в отличие от sudo echo команда с sudo tee будет работать?  
`echo string | sudo tee /root/new_file`  
Команда `tee` принимает входящий поток выводит его на стандартный вывод (stdout) и в файл (new_file)  
Команда с `sudo tee` будет работать потому что запущена с правами  `root`   
